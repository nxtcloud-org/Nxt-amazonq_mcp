<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë³‘ì› ì˜ì–‘ì†Œ ê²Œì„</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      min-height: 100vh;
    }
    
    #patient-selection {
      padding: 20px;
    }
    
    .patient-card {
      display: inline-block;
      margin: 10px;
      padding: 20px;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
      border: 2px solid transparent;
    }
    
    .patient-card:hover {
      background: rgba(255,255,255,0.2);
      border-color: #4caf50;
    }
    
    .patient-card.selected {
      border-color: #4caf50;
      background: rgba(76,175,80,0.2);
    }
    
    #game {
      position: relative;
      width: 400px;
      height: 600px;
      margin: 30px auto;
      border: 2px solid white;
      background: #222;
      overflow: hidden;
      display: none;
    }
    
    #player {
      position: absolute;
      bottom: 10px;
      width: 30px;
      height: 30px;
      background: #4caf50;
      left: 0;
      border-radius: 50%;
    }
    
    .nutrition-item {
      position: absolute;
      width: 50px;
      height: 50px;
      top: 0;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      font-weight: bold;
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid #333;
    }
    
    #info {
      margin-top: 10px;
      font-size: 18px;
      display: none;
    }
    
    #patient-info {
      margin: 10px 0;
      padding: 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 5px;
      display: none;
    }
    
    .life-heart {
      color: #f44336;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <h1>ğŸ¥ ë³‘ì› ì˜ì–‘ì†Œ ê²Œì„</h1>
  
  <div id="patient-selection">
    <h2>í™˜ìë¥¼ ì„ íƒí•˜ì„¸ìš”</h2>
    <div class="patient-card" data-patient="diabetes">
      <h3>ğŸ ë‹¹ë‡¨ë³‘ í™˜ì</h3>
      <p>ì €ë‹¹ë¶„ ì‹í’ˆì„ ë¨¹ê³ <br>ê³ ë‹¹ë¶„ ì‹í’ˆì„ í”¼í•˜ì„¸ìš”</p>
    </div>
    <div class="patient-card" data-patient="hypertension">
      <h3>ğŸ’“ ê³ í˜ˆì•• í™˜ì</h3>
      <p>ì €ì—¼ë¶„ ì‹í’ˆì„ ë¨¹ê³ <br>ê³ ì—¼ë¶„ ì‹í’ˆì„ í”¼í•˜ì„¸ìš”</p>
    </div>
    <div class="patient-card" data-patient="obesity">
      <h3>âš–ï¸ ë¹„ë§Œ í™˜ì</h3>
      <p>ì €ì¹¼ë¡œë¦¬ ì‹í’ˆì„ ë¨¹ê³ <br>ê³ ì¹¼ë¡œë¦¬ ì‹í’ˆì„ í”¼í•˜ì„¸ìš”</p>
    </div>
    <button id="start-game" style="display:none; margin-top:20px; padding:10px 20px; font-size:16px; background:#4caf50; color:white; border:none; border-radius:5px; cursor:pointer;">ê²Œì„ ì‹œì‘</button>
  </div>
  
  <div id="patient-info">
    <h3 id="selected-patient-name"></h3>
    <p id="patient-instructions"></p>
  </div>
  
  <div id="game">
    <div id="player"></div>
  </div>
  
  <div id="info">
    <div class="life-heart">â¤ï¸ ìƒëª…: <span id="lives">2</span></div>
    <div>ğŸ§® ì ìˆ˜: <span id="score">0</span> | â±ï¸ ì‹œê°„: <span id="time">0</span>ì´ˆ</div>
  </div>

  <script>
    // ê²Œì„ ìƒíƒœ
    let selectedPatient = null;
    let gameStarted = false;
    let gameOver = false;
    let lives = 2;
    let score = 0;
    let time = 0;
    let playerX = 0;
    let moveLeft = false;
    let moveRight = false;

    // í™˜ìë³„ ì˜ì–‘ì†Œ ë°ì´í„°
    const patientData = {
      diabetes: {
        name: "ğŸ ë‹¹ë‡¨ë³‘ í™˜ì",
        instructions: "ì €ë‹¹ë¶„ ì‹í’ˆ(ğŸ¥¬ğŸ…ğŸ¥’ğŸ¥•ğŸ¥¦)ì„ ë¨¹ê³ , ê³ ë‹¹ë¶„ ì‹í’ˆ(ğŸ°ğŸ­ğŸ«ğŸªğŸ©)ì„ í”¼í•˜ì„¸ìš”!",
        good: ["ğŸ¥¬", "ğŸ…", "ğŸ¥’", "ğŸ¥•", "ğŸ¥¦"],
        bad: ["ğŸ°", "ğŸ­", "ğŸ«", "ğŸª", "ğŸ©"]
      },
      hypertension: {
        name: "ğŸ’“ ê³ í˜ˆì•• í™˜ì", 
        instructions: "ì €ì—¼ë¶„ ì‹í’ˆ(ğŸ¥¬ğŸ…ğŸ¥’ğŸ¥•ğŸ¥¦)ì„ ë¨¹ê³ , ê³ ì—¼ë¶„ ì‹í’ˆ(ğŸŸğŸ•ğŸ¥“ğŸ–ğŸ§€)ì„ í”¼í•˜ì„¸ìš”!",
        good: ["ğŸ¥¬", "ğŸ…", "ğŸ¥’", "ğŸ¥•", "ğŸ¥¦"],
        bad: ["ğŸŸ", "ğŸ•", "ğŸ¥“", "ğŸ–", "ğŸ§€"]
      },
      obesity: {
        name: "âš–ï¸ ë¹„ë§Œ í™˜ì",
        instructions: "ì €ì¹¼ë¡œë¦¬ ì‹í’ˆ(ğŸ¥¬ğŸ…ğŸ¥’ğŸ¥•ğŸ¥¦)ì„ ë¨¹ê³ , ê³ ì¹¼ë¡œë¦¬ ì‹í’ˆ(ğŸ”ğŸŸğŸ•ğŸ°ğŸ«)ì„ í”¼í•˜ì„¸ìš”!",
        good: ["ğŸ¥¬", "ğŸ…", "ğŸ¥’", "ğŸ¥•", "ğŸ¥¦"],
        bad: ["ğŸ”", "ğŸŸ", "ğŸ•", "ğŸ°", "ğŸ«"]
      }
    };

    // DOM ìš”ì†Œë“¤
    const patientSelection = document.getElementById("patient-selection");
    const patientInfo = document.getElementById("patient-info");
    const game = document.getElementById("game");
    const player = document.getElementById("player");
    const startButton = document.getElementById("start-game");
    const selectedPatientName = document.getElementById("selected-patient-name");
    const patientInstructions = document.getElementById("patient-instructions");
    const livesEl = document.getElementById("lives");
    const scoreEl = document.getElementById("score");
    const timeEl = document.getElementById("time");
    const info = document.getElementById("info");

    // í™˜ì ì„ íƒ ì´ë²¤íŠ¸
    document.querySelectorAll('.patient-card').forEach(card => {
      card.addEventListener('click', () => {
        // ê¸°ì¡´ ì„ íƒ í•´ì œ
        document.querySelectorAll('.patient-card').forEach(c => c.classList.remove('selected'));
        
        // ìƒˆ ì„ íƒ
        card.classList.add('selected');
        selectedPatient = card.dataset.patient;
        
        // í™˜ì ì •ë³´ í‘œì‹œ
        const data = patientData[selectedPatient];
        selectedPatientName.textContent = data.name;
        patientInstructions.textContent = data.instructions;
        patientInfo.style.display = 'block';
        startButton.style.display = 'block';
      });
    });

    // ê²Œì„ ì‹œì‘
    startButton.addEventListener('click', () => {
      patientSelection.style.display = 'none';
      patientInfo.style.display = 'none';
      game.style.display = 'block';
      info.style.display = 'block';
      gameStarted = true;
      
      // í”Œë ˆì´ì–´ ì´ˆê¸° ìœ„ì¹˜
      playerX = (game.clientWidth - player.offsetWidth) / 2;
      player.style.left = playerX + "px";
      
      startGame();
    });

    // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
    document.addEventListener("keydown", (e) => {
      if (!gameStarted || gameOver) return;
      if (e.key === "ArrowLeft") moveLeft = true;
      if (e.key === "ArrowRight") moveRight = true;
    });

    document.addEventListener("keyup", (e) => {
      if (!gameStarted || gameOver) return;
      if (e.key === "ArrowLeft") moveLeft = false;
      if (e.key === "ArrowRight") moveRight = false;
    });

    function movePlayer() {
      if (moveLeft) playerX -= 5;
      if (moveRight) playerX += 5;

      const maxX = game.clientWidth - player.offsetWidth;
      playerX = Math.max(0, Math.min(maxX, playerX));
      player.style.left = playerX + "px";
    }

    function createNutritionItem() {
      const item = document.createElement("div");
      item.classList.add("nutrition-item");
      
      const data = patientData[selectedPatient];
      const isGood = Math.random() < 0.6; // 60% í™•ë¥ ë¡œ ì¢‹ì€ ì˜ì–‘ì†Œ
      const items = isGood ? data.good : data.bad;
      const randomItem = items[Math.floor(Math.random() * items.length)];
      
      item.textContent = randomItem;
      item.dataset.type = isGood ? "good" : "bad";
      
      item.style.left = Math.floor(Math.random() * (game.clientWidth - 50)) + "px";
      game.appendChild(item);

      let itemY = 0;
      const fall = setInterval(() => {
        if (gameOver) {
          clearInterval(fall);
          item.remove();
          return;
        }

        itemY += 2;
        item.style.top = itemY + "px";

        const itemRect = item.getBoundingClientRect();
        const playerRect = player.getBoundingClientRect();

        // ì¶©ëŒ ê²€ì‚¬
        if (
          itemRect.bottom >= playerRect.top &&
          itemRect.top <= playerRect.bottom &&
          itemRect.left < playerRect.right &&
          itemRect.right > playerRect.left
        ) {
          item.remove();
          clearInterval(fall);
          
          if (item.dataset.type === "good") {
            score += 10;
            scoreEl.textContent = score;
          } else {
            lives--;
            livesEl.textContent = lives;
            
            if (lives <= 0) {
              gameOver = true;
              alert("ğŸ’¥ ê²Œì„ ì˜¤ë²„! ì ìˆ˜: " + score);
              location.reload();
            }
          }
        }

        if (itemY > 600) {
          item.remove();
          clearInterval(fall);
        }
      }, 20);
    }

    function startGame() {
      // í”Œë ˆì´ì–´ ì´ë™
      setInterval(() => {
        if (!gameOver) movePlayer();
      }, 16);

      // ì‹œê°„ & ì ìˆ˜ ì—…ë°ì´íŠ¸
      setInterval(() => {
        if (gameOver) return;
        time++;
        timeEl.textContent = time;
      }, 1000);

      // ì˜ì–‘ì†Œ ìƒì„±
      setInterval(() => {
        if (!gameOver) createNutritionItem();
      }, 1500);
    }
  </script>
</body>
</html>
